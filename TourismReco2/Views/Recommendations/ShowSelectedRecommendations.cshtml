@model List<TourismReco2.Models.SelectedRecommendation>

@{
    ViewBag.Title = "title";
}

<h2>title</h2>
<div id="fh5co-page"  onload="initialize();calcRoute();">
    <script type="text/javascript" src="http://maps.google.com/maps/api/js?key=AIzaSyAoZTM1BsKycBiw_LrLlXzGqTf0tMdSGPk"></script>
@*    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>*@

    @using (Html.BeginForm("", "", FormMethod.Post, new { @class = "reco_form" }))
    {

        <div class="reco_form_overlay">

            @for (int i = 0; i < Model.Count; i++)
            {

                <ul class="list-group">

                        <li class="list-group-item">
                            @Html.CheckBoxFor(r => r[i].ChosenByUser) &nbsp; &nbsp; &nbsp;
                            @Model[i].Item.ItemName | @Model[i].CalcultedWeight
                            @Html.HiddenFor(r => r[i].ItemId)
                            @Html.HiddenFor(r => r[i].UserId)
                            @*@Html.HiddenFor(r => r.CalculatedRecommendations[i].ChosenByUser)*@
                        </li>
                </ul>

                @*        for (int j = 0; j < Model[i].SubClans.Count; j++)*@
                @*        {*@
                @*            @Html.HiddenFor(m => m[i].ClanId)*@
                @*            @Html.HiddenFor(m => m[i].SubClans[j].SubClanId)*@
                @*            @Html.TextBoxFor(m => m[i].SubClans[j].SubClanPriority, new { @class = "form-control small_textbox", Value = " " })*@
                @*            @Model[i].SubClans[j].SubClanName*@
                @*            <br />*@
                @*        }*@
                @*        @Html.HiddenFor(m => m[i].UserId)*@
                @*                <br />*@
                
            }
            
            <div id="map_canvas" style="width:70%; height:500px; float:left">
            </div>

            <div id="dirs" style="width:30%;height:100%;float:right;">
                <button onclick="">press me</button>
                <div id="directionsPanel" style="float:right;width:90%;height:500px; border-style:solid; border-width:5px;">

                </div>
            </div>
            
            <button type="submit" class="btn btn-primary">Submit</button>
            
            
            
            
            
            <script>
                var directionDisplay;
                var directionsService = new google.maps.DirectionsService();
                var map;
                var home = new google.maps.LatLng(@Model[0].Item.GeoPoint.Lat, @Model[0].Item.GeoPoint.Lng);

                var bars = new Array();
                var barss = new Array();


                @for (int i = 1; i < Model.Count; i++)
                {
                    <text>bars[@i] = new google.maps.LatLng(@Model[i].Item.GeoPoint.Lat, @Model[i].Item.GeoPoint.Lng);</text>

                }

//                bars[0] = new google.maps.LatLng(-46.4106428, 168.3490327); /* arnold's */
//                bars[1] = new google.maps.LatLng(-46.150729100000007, 168.0034769); /* the senate */
//                bars[2] = new google.maps.LatLng(-46.36342, 168.3595626); /* hofbrauhaus */
//                bars[3] = new google.maps.LatLng(-46.409493, 168.379822); /* Lavomatic */

                directionsDisplay = new google.maps.DirectionsRenderer();
                var myOptions = {
                    zoom:9,
                    mapTypeId: google.maps.MapTypeId.ROADMAP,
                    center: home
                };

                map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
                directionsDisplay.setMap(map);
                directionsDisplay.setPanel(document.getElementById("directionsPanel"));

                var start = home;
                var end = home;

                var request = {
                    origin:start,
                    destination:end,
                    waypoints: [
                    @for (int i = 1; i < Model.Count; i++)
                    {
                        <text>{ location: bars[@i], stopover: true },</text>
                    }
//                        { location: bars[1], stopover: true },
//                        {location:bars[2],stopover:true},
//                        {location:bars[3],stopover:true},
                    ],
                    optimizeWaypoints: true,
                    travelMode: google.maps.DirectionsTravelMode.DRIVING
                };


                directionsService.route(request, function(result, status) {
                    if (status == google.maps.DirectionsStatus.OK) {
                        directionsDisplay.setDirections(result);
                    }
                });

            </script>
            
        </div>

    }
</div>